# Subtask-001-06-01: 検証レポート生成

## 概要

PoC全体の検証結果をMarkdownレポートとして生成する。

## ユーザーストーリー

**As a** 開発者
**I want** 検証結果を構造化されたレポートにまとめる
**So that** 本格実装の可否と次のステップを判断できる

## Acceptance Criteria（EARS記法）

### レポート生成

- [ ] WHEN 開発者がレポート生成スクリプトを実行した際
      GIVEN 全検証ステップが完了している場合
      THEN `docs/poc-report.md` にレポートが生成される
      AND 生成日時が記載される

### レポート内容

- [ ] WHEN レポート内容を確認した際
      GIVEN レポートが生成されている場合
      THEN 以下のセクションが含まれる：
      1. 概要（目的・スコープ）
      2. 検証結果サマリー（成功/失敗の一覧）
      3. データ取得結果
      4. Embedding生成結果（コスト含む）
      5. タグ抽出結果（精度評価）
      6. 検索結果（ベクトル vs ハイブリッド比較）
      7. パフォーマンス計測結果
      8. コスト試算（本格実装時）
      9. 発見した課題・リスク
      10. 本格実装に向けた推奨事項

### 検証結果サマリー

- [ ] WHEN 検証結果サマリーを確認した際
      GIVEN 各検証項目の結果がある場合
      THEN 以下の形式で一覧表示される：
      | 検証項目 | 結果 | 備考 |
      |----------|------|------|
      | データ取得 | ✅ / ❌ | ... |
      | Embedding生成 | ✅ / ❌ | ... |
      | ... | ... | ... |

### コスト試算

- [ ] WHEN コスト試算セクションを確認した際
      GIVEN PoC実績データがある場合
      THEN 本格実装時の推定コストが記載される：
      - 全SCP記事（約10,000件）のEmbedding生成コスト
      - タグ抽出コスト
      - Supabase利用料（ストレージ・リクエスト）
      - 月間運用コスト概算

### 推奨事項

- [ ] WHEN 推奨事項セクションを確認した際
      GIVEN 検証結果がある場合
      THEN 以下が記載される：
      - 本格実装に進むべきか（Go / No-Go）
      - 技術選定の変更が必要か
      - 優先的に対処すべき課題
      - 次フェーズで検証すべき項目

## 設計

### レポートテンプレート

```markdown
# SCP Recommend PoC 検証レポート

**生成日時**: {timestamp}
**検証期間**: {start_date} - {end_date}

## 1. 概要

### 目的
SCP推薦システムの技術的実現可能性を検証する。

### スコープ
- データソース: SCP Data API (EN)
- 対象記事数: {article_count}件
- Embedding: OpenAI text-embedding-3-small
- ベクトルDB: Supabase pgvector

## 2. 検証結果サマリー

| 検証項目 | 結果 | 備考 |
|----------|------|------|
| データ取得 | {status} | {note} |
| Embedding生成 | {status} | {note} |
| タグ抽出 | {status} | {note} |
| ベクトル検索 | {status} | {note} |
| ハイブリッド検索 | {status} | {note} |

## 3. 詳細結果

### 3.1 データ取得
- 取得件数: {count}件
- 平均コンテンツ長: {avg_length}文字
- ...

### 3.2 Embedding生成
- 処理件数: {count}件
- 総トークン数: {tokens}
- 費用: ${cost}
- 処理時間: {time}秒
- ...

...

## 4. コスト試算

### PoC実績
| 項目 | 数量 | 単価 | 費用 |
|------|------|------|------|
| Embedding生成 | {tokens}トークン | $0.02/1M | ${cost} |
| タグ抽出 | {tokens}トークン | $0.XX/1M | ${cost} |

### 本格実装時（10,000記事）
| 項目 | 推定費用 |
|------|----------|
| 初期Embedding生成 | ${cost} |
| 月間運用 | ${cost} |

## 5. 発見した課題・リスク

1. {issue_1}
2. {issue_2}
...

## 6. 推奨事項

### Go / No-Go 判定
{judgment}

### 次のステップ
1. {step_1}
2. {step_2}
...
```

### スクリプト実行

```bash
# レポート生成
pnpm --filter poc run:05-report

# 特定セクションのみ
pnpm --filter poc run:05-report -- --section cost
```

## テストケース

- [ ] レポートファイルが生成される
- [ ] 全セクションが含まれる
- [ ] コスト計算が正しい
- [ ] 推奨事項が明確に記載される
