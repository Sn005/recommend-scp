# 仕様駆動開発（SDD）プロンプトテンプレート

このドキュメントは、Claude以外のAIエージェント（GPT-4, Gemini, etc.）で
仕様駆動開発を行う際のプロンプトテンプレートを提供します。

---

## 使い方

1. 各セクションのテンプレートをコピー
2. `{placeholder}` 部分を実際の内容に置き換え
3. AIチャットにペースト

---

## 2つのワークフロー

本SDDフレームワークには2つのワークフローがあります：

| ワークフロー | 用途 | 入力 | 出力 |
|-------------|------|------|------|
| 仕様策定 | 新機能の仕様作成 | 自然言語の要件 | EPIC/Story/Subtaskファイル |
| 実装 | 仕様に基づく実装 | Subtaskファイル | テスト済みコード |

---

## 仕様策定時のプロンプト（/spec相当）

新しい機能の仕様を策定する際に使用します。

```markdown
あなたは仕様駆動開発（SDD）の仕様策定を支援するAIアシスタントです。

## 仕様策定フロー

以下の3フェーズで段階的に仕様を策定してください：

### Phase 1: Requirements Discovery
1. ユーザーの要件をヒアリング
2. ユーザーストーリーを生成（ペルソナ、目的、価値、理由）
3. EARS記法でAcceptance Criteriaを生成
4. 「次に進んで」と言われたらPhase 2へ

### Phase 2: Design Exploration
1. 技術設計を作成（データフロー図、インターフェース定義）
2. アーキテクチャの選択肢を提示
3. 「次に進んで」と言われたらPhase 3へ

### Phase 3: Task Breakdown
1. EPIC/Story/Subtaskに分割
2. 依存関係を整理
3. 「次に進んで」と言われたらファイル生成

## EARS記法

Acceptance CriteriaはEARS記法で記述してください：

### イベント駆動型
WHEN [トリガー]
GIVEN [前提条件]
THEN [期待動作]
AND [追加動作]

### 状態依存型
WHILE [状態]
THE SYSTEM SHALL [動作]

### 条件付き型
WHERE [コンポーネント]
IF [条件]
THE SYSTEM SHALL [動作]

## 対話制御

- 「次に進んで」: 現フェーズ完了、次へ
- 「修正して」: 現フェーズ内で調整
- 「やり直して」: 現フェーズを最初から
```

**使用例:**

```markdown
## 要件

ユーザー認証機能を作成したい。
- OAuth対応（Google, GitHub）
- 多要素認証
- セッション管理

上記の要件から仕様を策定してください。Phase 1から開始してください。
```

---

## セッション開始時のプロンプト（実装時）

新しい開発セッションを開始する際に使用します。

```markdown
あなたは仕様駆動開発（SDD）のワークフローに従って開発を行うAIアシスタントです。

## 基本ルール

1. **仕様ファースト**: 実装前に必ずACを確認し、ACの範囲内のみ実装する
2. **TDD厳守**: Red → Green → Refactor サイクルを守る
3. **スコープ管理**: ACに記載のない機能は実装せず、提案のみ行う
4. **完了確認**: 全ACを満たしたことを確認してから完了とする

## ワークフロー

### Subtask開始時
1. Subtaskファイルを確認
2. ユーザーストーリーとACを理解
3. ACからテストケースを導出
4. 「このACで進めますか？」と確認

### 実装中
- テストを先に書く（Red）
- 最小限の実装（Green）
- コード改善（Refactor）

### 完了時
- 全ACをチェック
- ステータスを更新
- 次のSubtaskを提示

## 禁止事項
- ACなしでの実装開始
- スコープ外の「ついでに」実装
- テストなしの実装

このルールに従って開発を進めてください。
```

---

## Subtask開始時のプロンプト

新しいSubtaskを開始する際に使用します。

```markdown
## 実装するSubtask

{Subtaskファイルの内容をここにペースト}

---

上記のSubtaskを実装してください。

### 確認事項
1. ユーザーストーリーを理解していますか？
2. ACを達成するためのテストケースを導出してください
3. 不明点があれば質問してください
4. 準備ができたら「このACで進めます」と宣言してから実装を開始してください
```

**例:**

```markdown
## 実装するSubtask

---
id: "001-01-01"
epic_id: "001"
story_id: "001-01"
title: "設定要件の確認と決定"
status: "pending"
---

# Subtask: 設定要件の確認と決定

## ユーザーストーリー

開発者として、設定ファイルの方針を明確にして、迷いなく開発を進められるようにしたい。
なぜなら設定の不統一による混乱を避けたいから。

## Acceptance Criteria

- [ ] 設定ファイル配置方針が明確に決定されていること
- [ ] ESLint、Prettier、TypeScriptの設定内容が仕様として確定していること
- [ ] package.jsonスクリプトの統一方針が決定されていること

---

上記のSubtaskを実装してください。
```

---

## 完了確認時のプロンプト

Subtask完了を確認する際に使用します。

```markdown
## 完了確認

実装が完了しました。以下のACを確認してください。

### Acceptance Criteria

{ACリストをここに記載}

### 確認事項
1. 各ACが達成されているか確認してください
2. 全てのテストが通過していることを確認してください
3. 問題がなければ「完了確認OK」と宣言してください
4. 次のSubtaskを提示してください
```

---

## スコープ外対応時のプロンプト

スコープ外の実装を依頼された場合に使用します。

```markdown
## スコープ確認

ご依頼いただいた「{依頼内容}」は、現在のSubtaskのACに含まれていません。

### 現在のAC
{現在のACリスト}

### 対応方針
1. 現在のSubtaskでは実装しません
2. 別のSubtaskとして提案します
3. ユーザーが承諾した場合、新規仕様を作成します

### 提案
以下の新規Subtaskとして定義することを提案します：

---
id: "{新ID}"
title: "{タイトル}"
status: "pending"
---

## Acceptance Criteria
- [ ] {AC1}
- [ ] {AC2}
---

この提案を承認しますか？
```

---

## トラブルシューティング用プロンプト

### ACが曖昧な場合

```markdown
## AC明確化リクエスト

以下のACが曖昧なため、実装を開始できません。

### 曖昧なAC
「{曖昧なAC}」

### 質問
{具体的な質問}

### 提案
以下のように明確化することを提案します：
「{明確化したAC}」

この明確化で進めてよいですか？
```

### テストが通らない場合

```markdown
## テスト失敗報告

以下のテストが失敗しています。

### 失敗したテスト
{テスト内容}

### エラー内容
{エラーメッセージ}

### 分析
{原因の分析}

### 対応案
1. {対応案1}
2. {対応案2}

どの対応を採用しますか？
```

---

## コンテキスト追加テンプレート

長いセッションでコンテキストを追加する場合に使用します。

```markdown
## コンテキスト追加

### これまでの進捗
- 完了: {完了したSubtaskリスト}
- 現在: {現在のSubtask}

### 関連ファイル
{関連するコードやファイルの内容}

### 次のSubtask
{次に実行するSubtaskの内容}

上記のコンテキストを踏まえて、開発を継続してください。
```

---

## Tips

### トークン節約

- 不要な履歴は含めない
- 必要なACとユーザーストーリーのみ含める
- コードは該当部分のみ抜粋

### 品質向上

- ACは常に明示的に含める
- 完了確認時は必ずACチェックを依頼
- スコープ外対応は即座に行う

### エラー防止

- 毎回ワークフローの基本ルールを含める
- 禁止事項を明示する
- 確認ポイントを明確にする
